{% extends "base.html" %}
{% load static %}

{% block head %}
  <link rel="stylesheet" href="{% static 'css/group_detail.css' %}">
  <script defer src="{% static 'js/group_detail.js' %}"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}
<div class="dashboard">
    <aside class="sidebar">
        <div class="logo">
            <div class="logo-icon">üöÄ</div>
            <span class="logo-text">TaskFlow</span>
        </div>
        <nav class="menu">
            <ul>
                <li class="active"><i class="fas fa-users"></i> <span>–ì—Ä—É–ø–ø—ã</span></li>
                <li><i class="fas fa-tasks"></i> <span>–ó–∞–¥–∞—á–∏</span></li>
                <li><i class="fas fa-calendar-alt"></i> <span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</span></li>
            </ul>
        </nav>
        <div class="sidebar-footer">
            <div class="user-info dropdown">
                <div class="user-avatar">{{ user.username|slice:":1"|upper }}</div>
                <span class="username">{{ user.username }}</span>
                <div class="dropdown-menu">
                    <form action="{% url 'logout' %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="logout-btn">–í—ã–π—Ç–∏</button>
                    </form>
                </div>
            </div>
        </div>
    </aside>
    <main class="main-content">
        <div class="page-header">
            <h1>{{ group.name }}</h1>
        </div>
        <div class="stats-grid">
            <div class="stat-card neon-success">
                <div class="stat-icon"><i class="fas fa-user-check"></i></div>
                <div class="stat-details">
                    <span class="stat-label">–£—á–∞—Å—Ç–Ω–∏–∫–∏</span>
                    <span class="stat-value">{{ group.members.count }}</span>
                </div>
            </div>
            <div class="stat-card neon-streak">
                <div class="stat-icon"><i class="fas fa-tasks"></i></div>
                <div class="stat-details">
                    <span class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏</span>
                    <span class="stat-value">7</span>
                </div>
            </div>
            <div class="stat-card neon-warning" id="leaders-card" style="cursor:pointer;">
                <div class="stat-icon"><i class="fas fa-award"></i></div>
                <div class="stat-details">
                    <span class="stat-label">–õ–∏–¥–µ—Ä –º–µ—Å—è—Ü–∞</span>
                    <span class="stat-value">
                        {% if leaderboard %}
                            {{ leaderboard.0.user.username }}
                        {% else %}
                            ‚Äî
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
        <div class="tasks-section">
            <div class="section-header">
                <h2>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏</h2>
                <button class="btn-primary"><i class="fas fa-plus"></i> –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</button>
            </div>
            <div class="tasks-grid">
                <div class="task-group personal">
                    <div class="group-header">
                        <h3>–ù–µ–π—Ä–æ—Å–µ—Ç–∏</h3>
                        <span class="task-count">8/18</span>
                    </div>
                    <div class="tasks-list">
                        <div class="task-item">
                            <div class="task-icon">ü§ñ</div>
                            <div>
                                <div class="task-title">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è: CNN</div>
                                <div class="task-meta">
                                    <span class="discipline">–ù–µ–π—Ä–æ—Å–µ—Ç–∏</span>
                                    <span class="deadline">–î–æ 10.12</span>
                                </div>
                            </div>
                        </div>
                        <div class="task-item">
                            <div class="task-icon">üöÄ</div>
                            <div>
                                <div class="task-title">–ü—Ä–æ–µ–∫—Ç: SpaceX</div>
                                <div class="task-meta">
                                    <span class="discipline">–§–∏–∑–∏–∫–∞</span>
                                    <span class="deadline">–î–æ 15.12</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="task-group">
                    <div class="group-header">
                        <h3>–ò–¥–µ–∏ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤</h3>
                        <span class="task-count">12/18</span>
                    </div>
                    <div class="tasks-list">
                        <div class="task-item">
                            <div class="task-icon">üí°</div>
                            <div>
                                <div class="task-title">–ü—Ä–∏–¥—É–º–∞—Ç—å edtech-—Å—Ç–∞—Ä—Ç–∞–ø</div>
                                <div class="task-meta">
                                    <span class="discipline">–ë–∏–∑–Ω–µ—Å</span>
                                    <span class="deadline">–î–æ 06.12</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <div class="modal-overlay" id="leaders-modal">
        <div class="modal-content">
            <button class="modal-close" id="leaders-close">&times;</button>
            <h2>–¢–∞–±–ª–∏—Ü–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h2>

            <table style="width:100%; border-collapse: collapse; margin-top: 1rem;">
                <thead>
                    <tr style="border-bottom:1px solid rgba(255,255,255,0.15);">
                        <th style="text-align:left; padding: 8px 0;">–£—á–∞—Å—Ç–Ω–∏–∫</th>
                        <th style="text-align:right; padding: 8px 0;">–û—á–∫–∏</th>
                    </tr>
                </thead>
                <tbody>
                    {% for s in leaderboard %}
                    <tr style="border-bottom:1px solid rgba(255,255,255,0.05);">
                        <td style="padding: 8px 0;">{{ s.user.username }}</td>
                        <td style="text-align:right; padding: 8px 0; font-weight:700;">{{ s.total_points }}</td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="2" style="padding: 10px 0;">–ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    </main>
</div>
{% endblock %}
